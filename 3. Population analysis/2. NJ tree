# Convert vcf files to plink format
plink --vcf Pig.snps.filtered.simple.M2.vcf.gz --make-bed --out 1486.snp

# Quality control
plink --bfile 1486.snp --geno 0.01 --maf 0.1 --make-bed --out 1486.snp.qc
plink --bfile 1486.snp.qc --indep-pairwise 1000 1000 0.8 --out 1486.snp.qc.ld
plink --bfile 1486.snp.qc --extract 1486.snp.qc.d.prune.in --make-bed --out 1486.snp.qc.ld
plink --bfile 1486.snp.qc.ld --chr-set 18 --distance-matrix --out 1486.snp.qc.ld

# Obtain Mega Files
perl -e 'while(<>){chomp; @F = split/\s+/; $i++; print "[$i]#$F[1]\n"}' 1486.snp.qc.ld.mdist.id > 1486.snp.qc.ld.mega
perl -e 'print "[ "; while(<>){chomp; @F = split/\s+/; $i++; print "$i "} print "]\n" ' 1486.snp.qc.ld.mdist.id >> 1486.snp.qc.ld.mega
perl -e 'while(<>){chomp;my @F = split/\s+/; $i++; print "[$i]"; foreach (0..$i-2){print " $F[$_]"} print "\n"}' 1486.snp.qc.ld.mdist >> 1486.snp.qc.ld.mega

# Visualize on iTOL website （https://itol.embl.de/）
