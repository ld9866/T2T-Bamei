## Gene family analysis

./OrthoFinder-2.5.5/orthofinder.py -t 20 -a 20 -f ./all.pro

## Visualization

rm(list = ls())
library(tidyverse)
library(readxl)
library(patchwork)
setwd("C:\\Users\\xxx\\Desktop\\genefamily")

df <- read_xlsx("GeneFamilyAnalysis2.xlsx", sheet = 1, col_names = TRUE) %>%
  pivot_longer(cols = c("Core", "Pan"), names_to = "group", values_to = "value")

coredf <- df %>% filter(group == "Core")
pandf  <- df %>% filter(group == "Pan")

p1 <- ggplot(df, aes(x = `Individual Number`, y = value, color = group)) +
  geom_point(shape = 4, size = 6) +
  scale_x_continuous(breaks = seq(2, 28, by = 1)) +
  scale_y_continuous(labels = scales::number_format(), breaks = scales::pretty_breaks(n = 20)) +
  geom_smooth(coredf, method = "loess",
              mapping = aes(x = `Individual Number`, y = value),
              color = "black",
              se = FALSE) +
  geom_smooth(pandf, method = "loess",
              mapping = aes(x = `Individual Number`, y = value),
              color = "black",
              se = FALSE) +
  scale_color_manual(values = c("#D17431", "#39729C")) +
  labs(x = "Number of genomes", 
       y = "Number of gene families", 
       color = "") +
  theme_classic()

p1


